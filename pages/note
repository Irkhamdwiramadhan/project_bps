CREATE TABLE rpd_sakti (
    id INT AUTO_INCREMENT PRIMARY KEY,
    kode_unik_item VARCHAR(255) NOT NULL,
    bulan TINYINT UNSIGNED NOT NULL COMMENT '1=Jan ... 12=Des',
    jumlah DECIMAL(18,2) DEFAULT 0,
    tahun YEAR NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 3. Buat tabel pivot baru penghubung Mitra <-> Tim
CREATE TABLE mitra_tim (
  mitra_id INT(11) NOT NULL,
  tim_id INT(11) NOT NULL,
  PRIMARY KEY (mitra_id, tim_id),
  
  CONSTRAINT fk_mitra_tim_mitra 
    FOREIGN KEY (mitra_id) REFERENCES mitra(id) ON DELETE CASCADE,
    
  CONSTRAINT fk_mitra_tim_tim 
    FOREIGN KEY (tim_id) REFERENCES tim(id) ON DELETE CASCADE
) ENGINE=InnoDB;


ALTER TABLE mitra 
ADD COLUMN norek VARCHAR(30) AFTER email,
ADD COLUMN bank VARCHAR(50) AFTER norek;



ALTER TABLE mitra 
DROP PRIMARY KEY;

ALTER TABLE mitra 
MODIFY COLUMN id INT(11) NOT NULL AUTO_INCREMENT,
ADD PRIMARY KEY (id);

-- 1. Jadikan ID sebagai Primary Key
ALTER TABLE mitra_surveys
ADD PRIMARY KEY (id);

-- 2. AKTIFKAN AUTO INCREMENT (Ini yang paling penting agar ID otomatis jadi 1, 2, 3...)
ALTER TABLE mitra_surveys
MODIFY id INT(11) NOT NULL AUTO_INCREMENT;




-- 1. Set variabel penghitung mulai dari 0
SET @no = 0;

-- 2. Update kolom ID dengan nomor urut baru
-- Kita urutkan berdasarkan tanggal_input agar ID-nya rapi secara kronologis
UPDATE honor_mitra 
SET id = (@no := @no + 1) 
ORDER BY tanggal_input ASC;

ALTER TABLE honor_mitra
ADD PRIMARY KEY (id);

ALTER TABLE honor_mitra
MODIFY id INT(11) NOT NULL AUTO_INCREMENT;




-- 1. Kosongkan dulu tabel agar tidak error saat setting unique (opsional jika data masih tes)
TRUNCATE TABLE rpd_setting_waktu;

-- 2. Ubah struktur tabel agar ID auto increment dan TAHUN menjadi UNIQUE
ALTER TABLE `rpd_setting_waktu`
  CHANGE `id` `id` INT(11) NOT NULL AUTO_INCREMENT,
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_tahun` (`tahun`);


1. menghilangkan nilai null 
SELECT * FROM `honor_mitra` WHERE mitra_survey_id=821;

2. menambahkan kolom baru di tabel kegiatan_tim
ALTER TABLE kegiatan_anggota 
ADD COLUMN realisasi_anggota DECIMAL(10,2) DEFAULT 0 AFTER target_anggota;


senin
CREATE TABLE `kegiatan_pegawai` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `aktivitas` varchar(255) NOT NULL,
  `jenis_aktivitas` varchar(50) NOT NULL, -- Dinas Luar, Transport Lokal, Cuti, dll
  `tanggal` date NOT NULL,
  `waktu_mulai` time NOT NULL,
  `waktu_selesai` time NOT NULL,
  `tempat` varchar(100) DEFAULT NULL,
  `tim_kerja_id` int(11) DEFAULT NULL, -- Relasi ke tabel tim
  `jumlah_peserta` int(11) DEFAULT 0,
  `peserta_ids` text, -- Menyimpan ID pegawai: "1,5,10"
  `dibuat_pada` timestamp DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

ALTER TABLE kegiatan_pegawai MODIFY waktu_selesai VARCHAR(20);

-- 1. Ubah tim_kerja_id dari INT menjadi VARCHAR agar bisa simpan nama tim manual
ALTER TABLE kegiatan_pegawai MODIFY tim_kerja_id VARCHAR(255) NULL;

-- 2. Ubah peserta_ids menjadi TEXT (jika belum) agar muat banyak nama
ALTER TABLE kegiatan_pegawai MODIFY peserta_ids TEXT NULL;

Rabu
CREATE TABLE `kegiatan_harian` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `pegawai_id` int(11) NOT NULL, -- ID Pegawai yang login
  `tanggal` date NOT NULL,
  `jenis_kegiatan` varchar(50) NOT NULL, -- Dinas Luar, Rapat, WFH, dll
  `uraian` text NOT NULL,
  `jam_mulai` time NOT NULL,
  `jam_selesai` time NOT NULL,
  `tempat` varchar(100) DEFAULT NULL,
  `tim_kerja` varchar(100) DEFAULT NULL, -- Nama Tim
  `peserta` text DEFAULT NULL, -- Daftar nama peserta lain
  `output` varchar(255) DEFAULT NULL, -- Hasil/Output kegiatan (Opsional)
  `progress` int(3) DEFAULT 100, -- Persentase (0-100)
  `dibuat_pada` timestamp DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;